# 主成分分析

**PCA**（主成分分析，Principal Component Analysis）是一种用于数据降维和特征提取的统计方法，广泛应用于基因组学、数据分析等领域。PCA 的核心思想是通过将高维数据投影到低维空间中，以便捕获数据中的主要变异，减少冗余信息。

在 PCA 过程中，两个关键输出是**特征值**（eigenvalues）和**特征向量**（eigenvectors）。理解它们的含义是理解 PCA 的基础。

### 1. 特征值（Eigenvalues）

**特征值**是用于衡量数据的主成分（principal components）所解释的方差大小。换句话说，特征值表示每个主成分在原始数据中的**重要性**或**解释能力**。

- 在 PCA 中，数据的每个主成分都是一个新的线性组合，它们是数据中方差最大的方向。我们希望找到这些方差最大的方向，并用最少的几个方向解释尽可能多的数据变异。
- 特征值是这些主成分所携带的**方差大小**。方差越大，特征值越大，说明该主成分对解释原始数据的变异越重要。

#### 举个例子：

假设在一个二维数据集上，我们进行 PCA 分析，得到两个主成分。假设特征值为：

- 第一主成分的特征值 = 4.0
- 第二主成分的特征值 = 1.0

这表示**第一主成分**解释了数据中更大比例的变异，而**第二主成分**解释的数据变异较小。

- 如果两个特征值的总和为 5.0，则第一主成分解释了 4.0 \ 5.0 = 80% 的数据方差，第二主成分解释了 1.0 \ 5.0 = 20% 的数据方差。

!!! note
    特征值越大，表示对应的主成分越重要。
    特征值可以帮助你决定保留多少个主成分（通常保留总方差的一定百分比，如 90%）。

### 2. 特征向量（Eigenvectors）

**特征向量**决定了主成分的方向。它们表示的是数据在新的主成分坐标系中的投影方向。

- 特征向量是指在原始坐标系下，数据在每个主成分方向上的**投影方式**，也就是将高维数据降维到低维空间的"变换规则"。
- 每个特征向量是一个单位向量，表示原始维度如何组合成新的主成分。

#### 举个例子：

假设你有一个二维数据集，坐标轴是 x1x_1x1 和 x2x_2x2。通过 PCA 分析，你可能得到以下特征向量：

- 第一主成分的特征向量 = [0.8,0.6][0.8, 0.6][0.8,0.6]
- 第二主成分的特征向量 = [0.6,−0.8][0.6, -0.8][0.6,−0.8]

这意味着第一主成分是由 80%80\%80% 的 x1x_1x1 维度和 60%60\%60% 的 x2x_2x2 维度组合而成的。而第二主成分是由 60%60\%60% 的 x1x_1x1 和负 80%80\%80% 的 x2x_2x2 组成的。

这些向量定义了如何将原始数据转换到新的主成分空间。我们通过这些向量来理解数据如何在新的主成分空间中分布。

**总结**：

- 特征向量表示了主成分的方向，定义了新空间中每个主成分是如何组合原始维度的。
- 每个特征向量对应于一个特征值，表示该主成分的方向和它解释的变异比例。

### PCA 总结

1. **特征值**：衡量每个主成分解释的方差大小，决定了主成分的重要性。较大的特征值表明对应的主成分解释了更多的数据变异。
2. **特征向量**：定义主成分的方向，表示如何将原始特征转化为新的主成分。特征向量告诉我们每个原始特征如何贡献给新的主成分。

通过特征值和特征向量，PCA 将原始高维数据降维到低维空间，同时保留尽可能多的有用信息。这在生物信息学中非常重要，尤其是在处理基因型数据时，PCA 常用于校正人群结构和个体相关性问题。

### 图解

你可以将 PCA 看作是以下两个过程：

1. **特征值**：决定我们要沿哪些方向捕捉数据的主要变异。较大的特征值对应的主成分包含更多的信息。
2. **特征向量**：定义如何在这些方向上投影数据，以便捕捉尽可能多的数据变异。

PCA 的结果通常可以用散点图（以主成分为轴）可视化，通过图形展示数据中主成分解释的数据变异。